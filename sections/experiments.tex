\section{Experiments}
\textbf{Hardware and data collection.}
The experimental hardware consists of a SPAD array, lens, scintillator, and 1 $\mu$Ci Co-60 gamma-ray source.
We use the SPAD512 array (Pi Imaging) with microlenses for increased fill factor, 
which has $512 \times 512$ pixels and 16 $\mu$m pixel pitch.
The SPAD array is configured to capture 1-bit images with 1.5 $\mu$s 
integration time.
The lens is a 50 mm focal length Nikkor lens set to a f/1.2 aperture.
The scintillator is a GAGG(Ce)-HL crystal (Epic Crystal), which has a 150 ns decay 
constant, a 530 nm emission peak, and an index of refraction of 1.91.
Its geometry is a square pyramid with a 20 mm wide base, 5.77 mm 
height, and a 120 degree opening angle at the apex.
Four surfaces of the scintillator are coated with enhanced specular reflector.
The camera's lateral field of view (FOV) covers approximately $5.5 \times 5.5$ mm 
at the focal plane.
The scintillator is positioned such that its apex is in-focus and centered in the 
camera's FOV, and that the scintillator's base edges are parallel with the 
sensor's respective edges.
There is an air gap of approximately 30 mm between the scintillator and the lens.
The entire setup is placed inside a light-tight box to keep ambient light out.
The scintillator is shown in Supplementary Fig. \ref*{fig:scintillator}.
The experimental camera focus on the scintillator is shown in Supplementary Fig. \ref*{fig:experiment_focus}. 

Data collection took place at about 21 degrees Celsius ambient temperature.
We first captured 130,000 images without the gamma-ray source to characterize the 
dark count rate and zero out 5\% of pixels with the highest dark count rates.
After zeroing 5\% of pixels, we observe a median of 4 dark counts per image.
A histogram of dark counts per image is shown in Supplementary Fig. \ref*{fig:dark_counts_hist}.

We collect data by placing the gamma-ray source adjacent to the scintillator's 
apex and passively capturing images.
All computations are performed in post-processing.
Zeroing 5\% of pixels is applied to all images.
We capture 13,000,000 images with the gamma-ray source present and 
discard images with less than 60 counts.
Histograms of counts in an image are shown in Supplementary \cref*{fig:cap_counts_hist}.

\noindent
\textbf{Parameter values.}
See Supplementary \cref*{sec:params} for how camera parameters are calibrated and
what algorithm parameters are used on experimental data.


\noindent
\textbf{Kaleidoscopic image model validation.}
We select six experimental images and overlay the algorithm's estimated Gaussian 
components, shown in \cref{fig:example_figures}, to validate the presence of 
mirror reflections in accordance with the kaleidoscopic model.
Additional experimental images are shown in Supplementary \cref*{fig:example_figures_sup}.
\textcolor{red}{
Due to non-idealities, truncation zone boundaries in experimental images do not 
exactly match those derived theoretically using a thin lens.
We do not attempt to derive truncation lines in experimental images.
Rather, truncations are evident from missing mirror reflections in the selected images.}

\begin{figure*}
\centering
\includegraphics[width=\linewidth]{capture_examples.png}
\caption{\textbf{Selected experimental images.} Experimental images overlaid with the algorithm's estimated Gaussian components.
Each dashed red circle is centered on the Gaussian component's mean. 
The inner and outer circles are one and two standard deviations in radius, respectively.
Pixels with a photon are enlarged with a $3 \times 3$ filter for visualization purposes.
} 
\label{fig:example_figures}
\end{figure*}

\noindent
\textbf{Localization algorithm validation.}
Experimental events cannot be controlled, so their ground truth locations are unknown.
Therefore, to validate that the algorithm is measuring the event's location, we 
report agreement of multiple measurements of the event's location as follows.
We use experimental images that contain the event and four mirror reflections as 
test images.
The number of mirror reflections in an image is determined using the algorithm's 
initialization procedure.
Then, we create new images of the event by removing combinations of one or two 
mirror reflections from the image.
Photon $i$ is classified as belonging to mirror reflection $k$ according to 
$\max_k r_{ik}$ using $r_{ik}$ values obtained after running the algorithm's 
optimization procedure on the original test image with four mirror reflections.
Thus, for one test image, we generate 4 images with one mirror reflection removed 
and 6 images with two mirror reflections removed for a total of 11 images 
corresponding to one event.
We run the algorithm's initialization and optimization procedures on each image to 
obtain multiple measurements of the event's location.
We compute the mean estimated event location over the 11 images corresponding to 
one event.
We record the distance between the mean location and the estimated location for 
each individual image.
The distribution of this distance over all test images is used to report the 
agreement in event location measurements, where short distances indicate good 
agreement (high precision).
Selecting images that contain four mirror reflections and at least 60 counts 
resulted in 2,251 test images.
The median, mean, and standard deviation, respectively, of 
distances are 0.12 mm, 0.24 mm, and 0.34 mm over 24,761 distances.
Distances are reported in a histogram in Supplementary \cref*{fig:crossval_error}.

%Statistics on the distances in Group A over different ranges of photon counts in a 
%test image are reported in \cref{tab:crossval_thresh_error}.

We test for the algorithm's convergence by using two different initialization 
methods for $\bm{p_0}$. 
We either initialize $\bm{p_0}$ adaptively to the image as in the algorithm's 
initialization procedure or to $(0,0,1.5)$ mm in world coordinates.
We refer to the two initializations as ``regular" and ``fixed", respectively.
The test images for this convergence experiment consist of all experimental images 
that contain at least 60 counts, for a total of 4,351 images.
The median, mean, and standard deviation, respectively, of the relevant data are as follows:
\begin{itemize}
\item Distances between estimated event locations using the regular and fixed 
initialization methods: 0.007 mm, 0.38 mm, 0.80 mm.
\item Number of EM steps taken using regular initialization: 4 steps, 9.3 steps, 14.2 steps.
\item Number of EM steps taken using fixed initialization: 8 steps, 13.5 steps, 14.9 steps.
\end{itemize}
These data are reported in histograms in Supplementary \cref*{fig:convergence}.



\iffalse
\begin{table}[h!]
\centering
\begin{tabular}{|c|ccccc|}
\hline
Counts in a test image & 60 - 79 & 80 - 99 & 100 - 119 & 120 - 139 & 140 - 159 \\
\hline
Mean (mm)                & 0.28 & 0.26 & 0.19 & 0.19 & 0.15 \\
Standard dev.  (mm)      & 0.36 & 0.35 & 0.30 & 0.29 & 0.21  \\
Number of distances    & 9,317  & 7,524  & 4,774  & 2,354  & 792 \\
\hline
\end{tabular}
\caption{\textbf{Agreement in event location measurements.} Mean and standard 
deviation of distances between mean estimated event location and each image's 
estimated event location after both single and double mirror reflection removals 
(Group A) reported over different ranges of counts in a test image.}
\label{tab:crossval_thresh_error}
\end{table}
\fi

